package com.sobercompanion.util

/**
 * 흔들림 횟수에 따라 적절한 위로 메시지를 선택하는 유틸리티 오브젝트.
 *
 * 메시지 선택 전략:
 * - 1~3번째 흔들림: 고정 메시지 (순서대로, 점진적으로 공감 강도 높아짐)
 * - 4번째 이상: 순환 메시지 (인덱스 % 크기로 무한 순환)
 *
 * 메시지 추가/수정 시 FIXED_MESSAGES(3개 고정)와
 * ROTATING_MESSAGES(개수 자유)를 별도로 관리합니다.
 */
object ComfortMessageProvider {

    /**
     * 처음 1~3번 흔들릴 때 순서대로 보여주는 고정 메시지.
     * 첫 번째는 가볍게, 세 번째는 더 공감하는 톤으로 설계됐습니다.
     *
     * 인덱스: shakyCountToday - 1 (1번 → [0], 2번 → [1], 3번 → [2])
     */
    private val FIXED_MESSAGES = arrayOf(
        "그래도 기록 남긴 거, 잘했어.",
        "오늘 꽤 버티고 있네.",
        "오늘 쉽지 않은 날이네.\n여기까지 온 것도 충분해."
    )

    /**
     * 4번 이상 흔들릴 때 순환 방식으로 보여주는 메시지 목록.
     * 메시지를 추가하거나 삭제해도 기존 로직에 영향이 없습니다.
     * (인덱스를 배열 크기로 나눈 나머지를 사용하므로)
     */
    private val ROTATING_MESSAGES = arrayOf(
        "마음이 조금 흔들리고 있네.",
        "지금 순간이 꽤 묵직하다.",
        "생각이 자꾸 맴돌고 있구나.",
        "지금 네 마음, 충분히 이해해.",
        "힘든 날이지만, 여전히 여기 있잖아.",
        "잠깐 멈춰도 괜찮아.",
        "완벽하지 않아도 돼.",
        "지금 이 순간도 지나갈 거야.",
        "네가 느끼는 감정, 틀리지 않아.",
        "오늘 하루, 수고 많았어.",
        "작은 한 걸음도 걸음이야.",
        "괜찮지 않아도 괜찮아.",
        "지금 네가 할 수 있는 만큼이면 충분해.",
        "숨 한번 깊게 쉬어봐.",
        "네 속도대로 가면 돼.",
        "흔들려도 넘어진 건 아니야.",
        "오늘도 버텨줘서 고마워.",
        "지금 이 감정은 영원하지 않아.",
        "잘하고 있어, 정말로.",
        "네가 생각하는 것보다 강해.",
        "쉬어가는 것도 용기야.",
        "오늘 하루도 네 편이야.",
        "지금 이 순간, 너는 혼자가 아니야.",
        "작은 변화도 변화야.",
        "네 마음에 귀 기울여줘.",
        "포기하지 않은 것만으로 대단해.",
        "천천히, 하지만 꾸준히.",
        "오늘의 흔들림이 내일의 단단함이 돼.",
        "지금 느끼는 감정, 안아줘도 돼.",
        "넘어져도 다시 일어서는 게 진짜 힘이야.",
        "너는 이미 충분히 노력하고 있어.",
        "잠시 쉬어가도 방향은 같아.",
        "네가 걸어온 길을 돌아봐.",
        "오늘 하루, 잘 견뎌냈어.",
        "마음이 무거울 땐 내려놔도 돼.",
        "지금 이 순간에도 성장하고 있어.",
        "완벽한 하루는 없어, 괜찮아.",
        "네 존재 자체가 의미 있어.",
        "조금씩, 조금씩 나아가고 있어.",
        "힘든 만큼 더 단단해질 거야.",
        "오늘도 포기하지 않았잖아.",
        "네 감정을 존중해줘.",
        "이 시간도 결국 지나가.",
        "작은 승리를 축하해줘.",
        "지금 여기, 이 순간에 집중해봐.",
        "너는 혼자 싸우는 게 아니야.",
        "오늘은 파도가 높다."
    )

    /**
     * 오늘 흔들림 횟수에 맞는 위로 메시지를 반환합니다.
     *
     * @param shakyCountToday 오늘 흔들림 버튼을 누른 횟수 (0 이상)
     * @return 상황에 맞는 위로 메시지 문자열
     *
     * 선택 로직:
     * - 0번 (기록 없음): 고정 메시지[0]
     * - 1~3번: 고정 메시지[횟수-1]
     * - 4번 이상: 순환 메시지[(횟수-4) % 메시지수]
     */
    fun getMessage(shakyCountToday: Int): String {
        return when {
            shakyCountToday <= 0 -> FIXED_MESSAGES[0]
            shakyCountToday <= 3 -> FIXED_MESSAGES[shakyCountToday - 1]
            else -> {
                // 4번째부터는 순환: 4→[0], 5→[1], 6→[2], ...
                val index = (shakyCountToday - 4) % ROTATING_MESSAGES.size
                ROTATING_MESSAGES[index]
            }
        }
    }
}
